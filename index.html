<!DOCTYPE html><html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Controle de Vendas – Doces</title>
  <style>
    :root{
      --bg:#0b0c10;--card:#13151b;--ink:#e8edf2;--muted:#a8b3be;--accent:#4fd1c5;--danger:#ef4444;
      --ok:#22c55e;--warn:#f59e0b;--line:#232633;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial; background:var(--bg); color:var(--ink)}
    .wrap{max-width:1100px;margin:24px auto;padding:16px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--line)}
    header h1{font-size:20px;margin:0}
    header .actions{display:flex;gap:8px;flex-wrap:wrap}
    button{appearance:none;border:1px solid var(--line);background:#1a1e28;color:var(--ink);padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    button.primary{background:var(--accent);color:#041015;border-color:transparent}
    button.warn{background:var(--warn);color:#1b1202;border-color:transparent}
    button.danger{background:var(--danger);color:#1a0707;border-color:transparent}
    button:disabled{opacity:.6;cursor:not-allowed}
    .content{padding:18px}
    .grid{display:grid;grid-template-columns:1.2fr .8fr 1.2fr;gap:16px}
    @media (max-width:920px){.grid{grid-template-columns:1fr}}
    .panel{border:1px solid var(--line);border-radius:12px;padding:12px}
    .panel h2{margin:4px 8px 10px;font-size:16px;color:var(--muted)}table{width:100%;border-collapse:separate;border-spacing:0}
thead th{position:sticky;top:0;background:#151823;z-index:1}
th,td{border-bottom:1px solid var(--line);padding:10px 8px;text-align:left}
th{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:.04em}
tbody tr:last-child td{border-bottom:none}
tbody tr:hover{background:#151821}
.num{width:60px;text-align:center}
.price,.money{text-align:right}
input[type="number"]{width:100%;padding:8px 10px;background:#0f121a;color:var(--ink);border:1px solid #24283a;border-radius:8px}
input.small{max-width:110px}
.sum{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:6px 8px}
.sum label{display:flex;align-items:center;justify-content:space-between;gap:10px;background:#0f121a;border:1px solid #24283a;border-radius:10px;padding:10px}
.sum .out{font-weight:700}
.muted{color:var(--muted)}
.strong{font-weight:800}
.tag{font-size:12px;color:var(--muted)}
.total{font-size:18px}
.hr{height:1px;background:var(--line);margin:10px 0}
.note{color:var(--muted);font-size:12px;margin-top:8px}
footer{padding:16px 20px;border-top:1px solid var(--line);display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px}
.pill{background:#0f121a;border:1px solid #232633;border-radius:999px;padding:6px 12px}

  </style>
</head>
<body>
  <div class="wrap card">
    <header>
      <h1>Controle de Vendas – Doces</h1>
      <div class="actions">
        <button class="primary" id="btnCalc">Calcular</button>
        <button id="btnSalvar">Salvar</button>
        <button class="warn" id="btnLimpar">Limpar</button>
        <button class="danger" id="btnReset">Reset Geral</button>
        <button id="btnPrint">Imprimir</button>
      </div>
    </header><div class="content">
  <div class="grid">
    <section class="panel" style="grid-column:1/-1">
      <h2>Produtos</h2>
      <div class="tablewrap">
        <table id="tbl">
          <thead>
            <tr>
              <th class="num">Nº</th>
              <th class="price">Preço</th>
              <th>Início</th>
              <th>Abastecimento</th>
              <th>Sobra</th>
              <th>Venda</th>
              <th class="money">Valor Vendido</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
          <tfoot>
            <tr>
              <th colspan="6" class="total">Bruto (soma):</th>
              <th class="money total" id="bruto">R$ 0,00</th>
            </tr>
          </tfoot>
        </table>
      </div>
    </section>

    <section class="panel">
      <h2>Entradas Manuais</h2>
      <div class="sum">
        <label>Apoio (fixo)
          <input type="number" step="0.01" id="apoio" class="small" placeholder="0,00">
        </label>
        <label>Recebido (adiantado)
          <input type="number" step="0.01" id="recebido" class="small" placeholder="0,00">
        </label>
        <label>Gestão (retirado)
          <input type="number" step="0.01" id="gestao" class="small" placeholder="0,00">
        </label>
        <label>Pix (outros)
          <input type="number" step="0.01" id="pix" class="small" placeholder="0,00">
        </label>
      </div>
      <div class="note">Dica: preencha Início, Abastecimento e Sobra de cada produto. Depois informe os valores acima e clique em <strong>Calcular</strong>.</div>
    </section>

    <section class="panel">
      <h2>Percentuais</h2>
      <div class="sum">
        <label>15% (Seu)
          <span class="out" id="p15">R$ 0,00</span>
        </label>
        <label>5% (Gerente)
          <span class="out" id="p05">R$ 0,00</span>
        </label>
        <label>Líquido
          <span class="out" id="liquido">R$ 0,00</span>
        </label>
      </div>
    </section>

    <section class="panel">
      <h2>Fechamento</h2>
      <div class="sum">
        <label>Fexa (Líquido − Recebido − Gestão − Pix)
          <span class="out" id="fexa">R$ 0,00</span>
        </label>
        <label>Resumo (Fexa + 15%)
          <span class="out" id="resumo">R$ 0,00</span>
        </label>
      </div>
      <div class="hr"></div>
      <div class="note">"Resumo" segue sua folha: <em>Fexa + 15%</em>. Se quiser mudar a regra, é só falar.</div>
    </section>
  </div>
</div>

<footer>
  <div class="pill tag">Dados salvos localmente (este aparelho).</div>
  <div class="pill">© Você • App simples em HTML</div>
</footer>

  </div>  <script>
  // --- Configuração dos preços (N1..N23) ---
  const PRICES = [
    5,10,5,10,20,10,20,5,10,10,20,20,20,0,5,5,25,10,10,25,2,0,10
  ];

  const tbody = document.getElementById('tbody');
  const moneyBR = v => (isNaN(v)?0:v).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
  const val = id => parseFloat(document.getElementById(id).value.replace(',','.')) || 0;

  // Cria linhas da tabela
  const rows = [];
  for(let i=0;i<PRICES.length;i++){
    const tr = document.createElement('tr');
    const n = i+1; const price = PRICES[i];
    tr.innerHTML = `
      <td class="num">N${n}</td>
      <td class="price" data-price>${moneyBR(price)}</td>
      <td><input type="number" step="1" min="0" class="qtd" data-col="inicio"/></td>
      <td><input type="number" step="1" min="0" class="qtd" data-col="abastecimento"/></td>
      <td><input type="number" step="1" min="0" class="qtd" data-col="sobra"/></td>
      <td class="num venda" data-venda>0</td>
      <td class="money" data-valor>R$ 0,00</td>
    `;
    tbody.appendChild(tr);
    rows.push(tr);
  }

  // --- Cálculo ---
  function calcular(){
    let bruto = 0;
    rows.forEach((tr, idx)=>{
      const inputs = tr.querySelectorAll('input.qtd');
      const inicio = parseFloat(inputs[0].value)||0;
      const aba = parseFloat(inputs[1].value)||0;
      const sobra = parseFloat(inputs[2].value)||0;
      let venda = (inicio + aba - sobra);
      if(venda < 0) venda = 0; // evita negativo

      const valor = venda * PRICES[idx];
      tr.querySelector('[data-venda]').textContent = venda;
      tr.querySelector('[data-valor]').textContent = moneyBR(valor);
      bruto += valor;
    });

    document.getElementById('bruto').textContent = moneyBR(bruto);

    const p15 = +(bruto * 0.15).toFixed(2);
    const p05 = +(bruto * 0.05).toFixed(2);
    const apoio = val('apoio');
    const recebido = val('recebido');
    const gestao = val('gestao');
    const pix = val('pix');

    const liquido = +(bruto - p15 - p05 - apoio).toFixed(2);
    const fexa = +(liquido - recebido - gestao - pix).toFixed(2);
    const resumo = +(fexa + p15).toFixed(2);

    document.getElementById('p15').textContent = moneyBR(p15);
    document.getElementById('p05').textContent = moneyBR(p05);
    document.getElementById('liquido').textContent = moneyBR(liquido);
    document.getElementById('fexa').textContent = moneyBR(fexa);
    document.getElementById('resumo').textContent = moneyBR(resumo);
  }

  // Auto-cálculo ao digitar
  document.addEventListener('input', (e)=>{
    if(e.target.matches('input')){ calcular(); }
  });

  // Botões
  document.getElementById('btnCalc').addEventListener('click', calcular);
  document.getElementById('btnPrint').addEventListener('click', ()=>window.print());

  // Salvar & carregar (localStorage)
  const KEY='controle-doces-v1';
  function salvar(){
    const dados={rows:[],apoio:val('apoio'),recebido:val('recebido'),gestao:val('gestao'),pix:val('pix')};
    rows.forEach(tr=>{
      const [i,a,s] = [...tr.querySelectorAll('input.qtd')].map(x=>parseFloat(x.value)||0);
      dados.rows.push([i,a,s]);
    });
    localStorage.setItem(KEY, JSON.stringify(dados));
  }
  function carregar(){
    const raw = localStorage.getItem(KEY);
    if(!raw) return;
    try{
      const d = JSON.parse(raw);
      rows.forEach((tr,idx)=>{
        const arr = d.rows?.[idx]||[0,0,0];
        const inputs = tr.querySelectorAll('input.qtd');
        inputs[0].value = arr[0];
        inputs[1].value = arr[1];
        inputs[2].value = arr[2];
      });
      document.getElementById('apoio').value = d.apoio||'';
      document.getElementById('recebido').value = d.recebido||'';
      document.getElementById('gestao').value = d.gestao||'';
      document.getElementById('pix').value = d.pix||'';
      calcular();
    }catch(err){console.error(err)}
  }
  function limparCampos(){
    rows.forEach(tr=>tr.querySelectorAll('input.qtd').forEach(i=>i.value=''));
    document.getElementById('apoio').value='';
    document.getElementById('recebido').value='';
    document.getElementById('gestao').value='';
    document.getElementById('pix').value='';
    calcular();
  }
  function resetGeral(){ localStorage.removeItem(KEY); limparCampos(); }

  document.getElementById('btnSalvar').addEventListener('click', ()=>{salvar();alert('Dados salvos neste aparelho.');});
  document.getElementById('btnLimpar').addEventListener('click', limparCampos);
  document.getElementById('btnReset').addEventListener('click', ()=>{if(confirm('Apagar tudo e limpar?')) resetGeral();});

  // Inicializa
  carregar();
  calcular();
  </script></body>
</html>
